<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Boardie Order Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .thankyou {
      display: none;
      text-align: center;
      padding: 100px 20px;
    }
    .thankyou h2 {
      font-weight: bold;
      color: #28a745;
    }
    .thankyou p {
      font-size: 1.2rem;
    }
    .bkash-section {
      display: none;
      margin-top: 10px;
    }
  </style>

  <script>
    function updateTotal() {
      const p1 = document.getElementById('product1');
      const p2 = document.getElementById('product2');
      const p3 = document.getElementById('product3');

      const q1 = Number(document.getElementById('quantity1').value || 0);
      const q2 = Number(document.getElementById('quantity2').value || 0);
      const q3 = Number(document.getElementById('quantity3').value || 0);

      const total =
        q1 * Number(p1.value || 0) +
        q2 * Number(p2.value || 0) +
        q3 * Number(p3.value || 0);

      document.getElementById('total').textContent = total;
    }

    function togglePaymentFields() {
      const paymentMethod = document.getElementById('payment-method').value;
      const bkashSection = document.getElementById('bkash-section');
      const transactionInput = document.getElementById('transaction-id');

      if(paymentMethod === 'Bkash') {
        bkashSection.style.display = 'block';
        transactionInput.required = true;
      } else {
        bkashSection.style.display = 'none';
        transactionInput.required = false;
        transactionInput.value = '';
      }
    }

    async function submitForm(e) {
      e.preventDefault();

      const p1 = document.getElementById('product1');
      const p2 = document.getElementById('product2');
      const p3 = document.getElementById('product3');

      const paymentMethod = document.getElementById('payment-method').value;
      const transactionID = document.getElementById('transaction-id').value;

      // If Bkash is selected, make sure transaction ID is filled
      if(paymentMethod === 'Bkash' && transactionID.trim() === '') {
        alert('Please enter the Bkash transaction ID.');
        return;
      }

      const data = {
        name: document.getElementById('name').value,
        mobile: document.getElementById('mobile').value,
        email: document.getElementById('email').value,
        address: document.getElementById('address').value,
        product1: p1.options[p1.selectedIndex].text,
        quantity1: document.getElementById('quantity1').value,
        product2: p2.options[p2.selectedIndex].text,
        quantity2: document.getElementById('quantity2').value,
        product3: p3.options[p3.selectedIndex].text,
        quantity3: document.getElementById('quantity3').value,
        total: document.getElementById('total').textContent,
        paymentMethod: document.getElementById('payment-method').value,
        transactionID: document.getElementById('transaction-id').value
      };

      const scriptURL = "https://script.google.com/macros/s/AKfycbwdeqy9sSKS_fV7XXYvmLTmbKehNMdQw4U5v86LmX-EfMAj-pX_rBev71EokrJhzTZx/exec"; // Replace with your Google Apps Script URL

      try {
        const response = await fetch(scriptURL, {
          method: 'POST',
          body: JSON.stringify(data)
        });

        if (response.ok) {
          document.getElementById('order-section').style.display = 'none';
          document.getElementById('thankyou-section').style.display = 'block';
        } else {
          alert('‚ö†Ô∏è There was a problem submitting your order. Please try again.');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('‚ùå Network error. Please check your connection and try again.');
      }
    }
  </script>
</head>

<body class="bg-light">
  <div class="container py-5">
    <div id="order-section">
      <h2 class="mb-4 text-center fw-bold">üõí Boardie Order Form</h2>

      <form id="order-form" onsubmit="submitForm(event)" class="bg-white p-4 rounded shadow">
        <!-- Customer Info -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Name</label>
            <input type="text" id="name" class="form-control" placeholder="Your Name" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Mobile</label>
            <input type="text" id="mobile" class="form-control" placeholder="e.g. 017XXXXXXXX" required>
          </div>
        </div>

        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Email</label>
            <input type="email" id="email" class="form-control" placeholder="you@example.com">
          </div>
          <div class="col-md-6">
            <label class="form-label">Delivery Address</label>
            <input type="text" id="address" class="form-control" placeholder="Your Delivery Address" required>
          </div>
        </div>

        <hr>
        <h5 class="fw-bold mb-3">Select Products</h5>

        <!-- Product 1 -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Choose 1st Game</label>
            <select id="product1" class="form-select" onchange="updateTotal()">
              <option value="3670">Root (‡ß≥3670)</option>
              <option value="3340">Brass: Birmingham (‡ß≥3340)</option>
              <option value="3560">Harmonies (‡ß≥3560)</option>
              <option value="4430">Everdell (‡ß≥4430)</option>
              <option value="2870">Azul (‡ß≥2870)</option>
              <option value="3640">7 Wonders (‡ß≥3640)</option>
              <option value="830">Virus 1 (‡ß≥830)</option>
              <option value="3560">Pandemic (‡ß≥3560)</option>
              <option value="2350">Splendor (‡ß≥2350)</option>
              <option value="1440">Here to Slay (‡ß≥1440)</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Quantity</label>
            <input type="number" id="quantity1" min="0" value="0" class="form-control" oninput="updateTotal()">
          </div>
        </div>

        <!-- Product 2 -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Choose 2nd Game</label>
            <select id="product2" class="form-select" onchange="updateTotal()">
              <option value="3670">Root (‡ß≥3670)</option>
              <option value="3340">Brass: Birmingham (‡ß≥3340)</option>
              <option value="3560">Harmonies (‡ß≥3560)</option>
              <option value="4430">Everdell (‡ß≥4430)</option>
              <option value="2870">Azul (‡ß≥2870)</option>
              <option value="3640">7 Wonders (‡ß≥3640)</option>
              <option value="830">Virus 1 (‡ß≥830)</option>
              <option value="3560">Pandemic (‡ß≥3560)</option>
              <option value="2350">Splendor (‡ß≥2350)</option>
              <option value="1440">Here to Slay (‡ß≥1440)</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Quantity</label>
            <input type="number" id="quantity2" min="0" value="0" class="form-control" oninput="updateTotal()">
          </div>
        </div>

        <!-- Product 3 -->
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Choose 3rd Game</label>
            <select id="product3" class="form-select" onchange="updateTotal()">
              <option value="3670">Root (‡ß≥3670)</option>
              <option value="3340">Brass: Birmingham (‡ß≥3340)</option>
              <option value="3560">Harmonies (‡ß≥3560)</option>
              <option value="4430">Everdell (‡ß≥4430)</option>
              <option value="2870">Azul (‡ß≥2870)</option>
              <option value="3640">7 Wonders (‡ß≥3640)</option>
              <option value="830">Virus 1 (‡ß≥830)</option>
              <option value="3560">Pandemic (‡ß≥3560)</option>
              <option value="2350">Splendor (‡ß≥2350)</option>
              <option value="1440">Here to Slay (‡ß≥1440)</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Quantity</label>
            <input type="number" id="quantity3" min="0" value="0" class="form-control" oninput="updateTotal()">
          </div>
        </div>

        <!-- Total -->
        <div class="text-end mb-3">
          <h5>Total: ‡ß≥<span id="total">0</span></h5>
        </div>

        <!-- Payment Method -->
        <div class="mb-3">
          <label class="form-label">Payment Method</label>
          <select id="payment-method" class="form-select" onchange="togglePaymentFields()" required>
            <option value="">Select Payment Method</option>
            <option value="Bkash">Bkash</option>
            <option value="Cash on Delivery">Cash on Delivery</option>
          </select>
        </div>

        <!-- Bkash Transaction -->
        <div id="bkash-section" class="bkash-section">
          <p>Send Money to Bkash Account: <strong>01784597298</strong>. After sending money, fill up the Bkash transaction ID:</p>
          <input type="text" id="transaction-id" class="form-control" placeholder="Enter Bkash Transaction ID">
        </div>

        <button type="submit" class="btn btn-success w-100 fs-5 mt-3">Submit Order</button>
      </form>
    </div>

    <!-- Thank You Page -->
    <div id="thankyou-section" class="thankyou">
      <h2>üéâ Thank You for Your Order!</h2>
      <p>We‚Äôve received your order details. Our team will contact you soon for confirmation.</p>
      <a href="index.html" class="btn btn-primary mt-3">Go to Home</a>
    </div>
  </div>
</body>
</html>
